using System;
using System.Collections;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace FilmAdvisor
{
    public class Parameters : IParameters
    {
        private Dictionary<string, object> parameters { get; }

        public Parameters()
        {
            
        }

        public Parameters(IEnumerable<KeyValuePair<string, object>> p)
        {
            #region kp mapping
            var genres = new Dictionary<string, int> {
                ["аниме"] = 1750,
                ["биография"] = 22,
                ["боевик"] = 3,
                ["вестерн"] = 13,
                ["военный"] = 19,
                ["детектив"] = 17,
                ["детский"] = 456,
                ["для взрослых"] = 20,
                ["документальный"] = 12,
                ["драма"] = 8,
                ["игра"] = 27,
                ["история"] = 23,
                ["комедия"] = 6,
                ["концерт"] = 1747,
                ["короткометражка"] = 15,
                ["криминал"] = 16,
                ["мелодрама"] = 7,
                ["музыка"] = 21,
                ["мультфильм"] = 14,
                ["мюзикл"] = 9,
                ["новости"] = 28,
                ["приключения"] = 10,
                ["реальное ТВ"] = 25,
                ["семейный"] = 11,
                ["спорт"] = 24,
                ["триллер"] = 4,
                ["ужасы"] = 1,
                ["фантастика"] = 2,
                ["фэнтези"] = 5,
                ["церемония"] = 1751
            };
            var countries = new Dictionary<string, int> {
                ["Россия"] = 2,
                ["США"] = 1,
                ["СССР"] = 13,
                ["Австралия"] = 25,
                ["Австрия"] = 57,
                ["Азербайджан"] = 136,
                ["Албания"] = 120,
                ["Алжир"] = 20,
                ["Американские Виргинские острова"] = 1026,
                ["Американское Самоа"] = 1062,
                ["Ангола"] = 139,
                ["Андорра"] = 159,
                ["Антарктида"] = 1044,
                ["Антигуа и Барбуда"] = 1030,
                ["Антильские Острова"] = 1009,
                ["Аргентина"] = 24,
                ["Армения"] = 89,
                ["Аруба"] = 175,
                ["Афганистан"] = 113,
                ["Багамы"] = 124,
                ["Бангладеш"] = 75,
                ["Барбадос"] = 105,
                ["Бахрейн"] = 164,
                ["Беларусь"] = 69,
                ["Белиз"] = 173,
                ["Бельгия"] = 41,
                ["Бенин"] = 140,
                ["Берег Слоновой кости"] = 109,
                ["Бермуды"] = 1004,
                ["Бирма"] = 148,
                ["Болгария"] = 63,
                ["Боливия"] = 118,
                ["Босния"] = 178,
                ["Ботсвана"] = 145,
                ["Бразилия"] = 10,
                ["Бурунди"] = 162,
                ["Бутан"] = 114,
                ["Вануату"] = 1059,
                ["Великобритания"] = 11,
                ["Венгрия"] = 49,
                ["Венесуэла"] = 72,
                ["Внешние малые острова США"] = 1064,
                ["Восточная Сахара"] = 1043,
                ["Вьетнам"] = 52,
                ["Вьетнам Северный"] = 170,
                ["Габон"] = 127,
                ["Гаити"] = 99,
                ["Гайана"] = 165,
                ["Гамбия"] = 1040,
                ["Гана"] = 144,
                ["Гваделупа"] = 142,
                ["Гватемала"] = 135,
                ["Гвинея"] = 129,
                ["Германия"] = 3,
                ["Гибралтар"] = 1022,
                ["Гондурас"] = 112,
                ["Гонконг"] = 28,
                ["Гренада"] = 1060,
                ["Гренландия"] = 117,
                ["Греция"] = 55,
                ["Грузия"] = 61,
                ["Гуам"] = 1045,
                ["Дания"] = 4,
                ["Демократическая Республика Конго"] = 1037,
                ["Джибути"] = 1028,
                ["Доминика"] = 1031,
                ["Доминикана"] = 128,
                ["Египет"] = 101,
                ["Заир"] = 155,
                ["Замбия"] = 133,
                ["Зимбабве"] = 104,
                ["Израиль"] = 42,
                ["Индия"] = 29,
                ["Индонезия"] = 73,
                ["Иордания"] = 154,
                ["Ирак"] = 90,
                ["Иран"] = 48,
                ["Ирландия"] = 38,
                ["Исландия"] = 37,
                ["Испания"] = 15,
                ["Италия"] = 14,
                ["Йемен"] = 169,
                ["Казахстан"] = 122,
                ["Каймановы острова"] = 1051,
                ["Камбоджа"] = 84,
                ["Камерун"] = 95,
                ["Канада"] = 6,
                ["Катар"] = 1002,
                ["Кения"] = 100,
                ["Кипр"] = 64,
                ["Кирибати"] = 1024,
                ["Китай"] = 31,
                ["Колумбия"] = 56,
                ["Коморы"] = 1058,
                ["Конго"] = 134,
                ["Корея"] = 156,
                ["Корея Северная"] = 137,
                ["Корея Южная"] = 26,
                ["Косово"] = 1013,
                ["Куба"] = 76,
                ["Кувейт"] = 147,
                ["Кыргызстан"] = 86,
                ["Лаос"] = 149,
                ["Латвия"] = 54,
                ["Лесото"] = 1015,
                ["Либерия"] = 176,
                ["Ливан"] = 97,
                ["Ливия"] = 126,
                ["Литва"] = 123,
                ["Лихтенштейн"] = 125,
                ["Люксембург"] = 59,
                ["Маврикий"] = 115,
                ["Мавритания"] = 67,
                ["Мадагаскар"] = 150,
                ["Макао"] = 153,
                ["Македония"] = 80,
                ["Малави"] = 1025,
                ["Малайзия"] = 83,
                ["Мали"] = 151,
                ["Мальдивы"] = 1050,
                ["Мальта"] = 111,
                ["Марокко"] = 43,
                ["Мартиника"] = 102,
                ["Маршалловы острова"] = 1067,
                ["Масаи"] = 1042,
                ["Мексика"] = 17,
                ["Мелкие отдаленные острова США"] = 1041,
                ["Мозамбик"] = 81,
                ["Молдова"] = 58,
                ["Монако"] = 22,
                ["Монголия"] = 132,
                ["Монтсеррат"] = 1065,
                ["Мьянма"] = 1034,
                ["Намибия"] = 91,
                ["Непал"] = 106,
                ["Нигер"] = 157,
                ["Нигерия"] = 110,
                ["Нидерланды"] = 12,
                ["Никарагуа"] = 138,
                ["Новая Зеландия"] = 35,
                ["Новая Каледония"] = 1006,
                ["Норвегия"] = 33,
                ["ОАЭ"] = 119,
                ["Оккупированная Палестинская территория"] = 1019,
                ["Оман"] = 1003,
                ["Остров Мэн"] = 1052,
                ["Остров Святой Елены"] = 1047,
                ["Острова Кука"] = 1063,
                ["острова Теркс и Кайкос"] = 1007,
                ["Пакистан"] = 74,
                ["Палау"] = 1057,
                ["Палестина"] = 78,
                ["Панама"] = 107,
                ["Парагвай"] = 143,
                ["Перу"] = 23,
                ["Польша"] = 32,
                ["Португалия"] = 36,
                ["Пуэрто Рико"] = 82,
                ["Реюньон"] = 1036,
                ["Российская империя"] = 1033,
                ["Россия"] = 2,
                ["Руанда"] = 103,
                ["Румыния"] = 46,
                ["Сальвадор"] = 121,
                ["Самоа"] = 1039,
                ["Саудовская Аравия"] = 158,
                ["Свазиленд"] = 1029,
                ["Сейшельские острова"] = 1010,
                ["Сенегал"] = 65,
                ["Сербия"] = 177,
                ["Сербия и Черногория"] = 174,
                ["Сиам"] = 1021,
                ["Сингапур"] = 45,
                ["Сирия"] = 98,
                ["Словакия"] = 94,
                ["Словения"] = 40,
                ["Соломоновы Острова"] = 1069,
                ["Сомали"] = 160,
                ["СССР"] = 13,
                ["Судан"] = 167,
                ["Суринам"] = 171,
                ["США"] = 1,
                ["Таджикистан"] = 70,
                ["Таиланд"] = 44,
                ["Тайвань"] = 27,
                ["Танзания"] = 130,
                ["Того"] = 161,
                ["Тонга"] = 1012,
                ["Тринидад и Тобаго"] = 88,
                ["Тувалу"] = 1053,
                ["Тунис"] = 50,
                ["Туркменистан"] = 152,
                ["Турция"] = 68,
                ["Уганда"] = 172,
                ["Узбекистан"] = 71,
                ["Украина"] = 62,
                ["Уругвай"] = 79,
                ["Фарерские острова"] = 1008,
                ["Федеративные Штаты Микронезии"] = 1038,
                ["Фиджи"] = 166,
                ["Филиппины"] = 47,
                ["Финляндия"] = 7,
                ["Франция"] = 8,
                ["Французская Гвиана"] = 1032,
                ["Французская Полинезия"] = 1046,
                ["Хорватия"] = 85,
                ["ЦАР"] = 141,
                ["Чад"] = 77,
                ["Черногория"] = 1020,
                ["Чехия"] = 34,
                ["Чехословакия"] = 16,
                ["Чили"] = 51,
                ["Швейцария"] = 21,
                ["Швеция"] = 5,
                ["Эквадор"] = 96,
                ["Экваториальная Гвинея"] = 1061,
                ["Эритрея"] = 87,
                ["Эстония"] = 53,
                ["Эфиопия"] = 168,
                ["ЮАР"] = 30,
                ["Югославия"] = 19,
                ["Ямайка"] = 93,
                ["Япония"] = 9
            };
            #endregion
            //эти нужны всегда
            parameters = new Dictionary<string, object>
            {
                ["level"] = 7,
                ["from"] = "forma",
                ["result"] = "adv",
                ["m_act[from]"] = "forma",
                ["m_act[what]"] = "content"
            };

            foreach (var param in p)
            {
                var key = param.Key.ToLower();
                var val = param.Value;
                if (key == "genre")
                    val = genres[val.ToString()];
                else if (key == "country")
                    val = countries[val.ToString()];
                Add(string.Format("m_act[{0}]", key), val);
            }
        }

        public void Add(string name, object obj)
        {
            parameters.Add(name, obj);
        }

        public IEnumerator<KeyValuePair<string, object>> GetEnumerator()
        {
            return parameters.GetEnumerator();
        }

        IEnumerator IEnumerable.GetEnumerator()
        {
            return parameters.GetEnumerator();
        }
    }
}
